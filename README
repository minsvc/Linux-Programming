source code from https://sites.fas.harvard.edu/~lib215/reference/bookcode/code/all
